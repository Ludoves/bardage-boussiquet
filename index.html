<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calcul Bardage + Couvre-joints</title>

<!-- PWA / iPhone -->
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icon.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-title" content="Bardage Boussiquet">
<meta name="theme-color" content="#1c1c1e">

<style>
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
    background-color: #1c1c1e;
    color:#fff;
    margin:0;
    padding:0;
}

.container {
    max-width: 420px;
    margin:40px auto;
    background:#2c2c34;
    padding:20px 25px;
    border-radius:20px;
    box-shadow:0 8px 20px rgba(0,0,0,0.3);
}

h1 {
    text-align:center;
    font-weight:600;
    margin-bottom:10px;
}

.logo {
    display:block;
    margin:0 auto 15px;
    max-width:120px;
}

label {
    display:block;
    margin-top:15px;
    font-weight:500;
}

input[type="number"] {
    width:100%;
    padding:10px 12px;
    margin-top:6px;
    border-radius:12px;
    border:1px solid #555;
    font-size:16px;
    background:#3c3c46;
    color:#fff;
}

input[type="checkbox"] {
    margin-right:10px;
    transform:scale(1.3);
}

.toggle-label {
    display:flex;
    align-items:center;
    margin-top:15px;
}

.buttons-pertes {
    display:flex;
    justify-content:space-between;
    margin-top:8px;
}

.buttons-pertes button {
    flex:1;
    margin:0 5px;
    padding:10px 0;
    border:none;
    border-radius:12px;
    background-color:#007aff;
    color:#fff;
    font-weight:600;
    font-size:16px;
    cursor:pointer;
}

.result {
    margin-top:25px;
    background-color:#3c3c46;
    padding:15px 20px;
    border-radius:16px;
    text-align:center;
    font-size:16px;
    font-weight:600;
    line-height:1.5;
}

h2 {
    text-align:center;
    margin-top:10px;
}

hr {
    margin:20px 0;
    border-color:#555;
}
</style>
</head>

<body>
<div class="container">

    <!-- Logo affiché dans l'app -->
    <img src="icon.png" alt="Logo Boussiquet" class="logo">

    <h1>Calcul Bardage</h1>

    <!-- Bardage -->
    <label>Surface totale (m²)
        <input type="number" id="surface" value="0" step="0.1">
    </label>

    <label>Largeur de lame (mm)
        <input type="number" id="largeurLame" value="100">
    </label>

    <label>Longueur des lames (m)
        <input type="number" id="longueurLame" value="3" step="0.1">
    </label>

    <label>Pertes (%)</label>
    <div class="buttons-pertes">
        <button data-pertes="5">5%</button>
        <button data-pertes="10">10%</button>
        <button data-pertes="15">15%</button>
    </div>

    <input type="number" id="pertes" value="10" style="margin-top:10px;">

    <hr>

    <!-- Options -->
    <label class="toggle-label">
        <input type="checkbox" id="claireVoie"> Claire-voie
    </label>

    <div id="espacementSection" style="display:none;">
        <label>Espacement (mm)
            <input type="number" id="espacement" value="20">
        </label>
    </div>

    <label class="toggle-label">
        <input type="checkbox" id="includeCouv" checked> Inclure couvre-joints
    </label>

    <div id="couvSection">
        <h2>Couvre-joints</h2>

        <label>Largeur du mur (m)
            <input type="number" id="largeurMur" step="0.1">
        </label>

        <label>Hauteur du mur (m)
            <input type="number" id="hauteurMur" step="0.1">
        </label>

        <label>Longueur des couvre-joints (m)
            <input type="number" id="longueurCouv" value="3" step="0.1">
        </label>
    </div>

    <div class="result" id="result"></div>
</div>

<script>
const surface = document.getElementById("surface");
const largeurLame = document.getElementById("largeurLame");
const longueurLame = document.getElementById("longueurLame");
const pertes = document.getElementById("pertes");
const claireVoie = document.getElementById("claireVoie");
const espacement = document.getElementById("espacement");
const espacementSection = document.getElementById("espacementSection");

const largeurMur = document.getElementById("largeurMur");
const hauteurMur = document.getElementById("hauteurMur");
const longueurCouv = document.getElementById("longueurCouv");
const includeCouv = document.getElementById("includeCouv");

const result = document.getElementById("result");

function calculer() {
    const s = parseFloat(surface.value) || 0;
    const lame = parseFloat(largeurLame.value) || 0;
    const vide = claireVoie.checked ? (parseFloat(espacement.value) || 0) : 0;
    const lgLame = parseFloat(longueurLame.value) || 1;
    const p = parseFloat(pertes.value) || 0;

    const pas = (lame + vide) / 1000;
    const ratio = pas > 0 ? 1 / pas : 0;
    const ratioPerte = ratio * (1 + p / 100);
    const totalML = s * ratioPerte;
    const nbLames = Math.ceil(totalML / lgLame);

    let mlCouv = 0;
    let nbCouv = 0;

    if (includeCouv.checked && largeurMur.value && hauteurMur.value) {
        nbCouv = Math.max(Math.floor(largeurMur.value / pas) - 1, 0);
        mlCouv = nbCouv * (parseFloat(longueurCouv.value) || hauteurMur.value);
    }

    result.innerHTML = `
        Ratio brut : ${ratio.toFixed(2)} ml/m²<br>
        Ratio avec pertes : ${ratioPerte.toFixed(2)} ml/m²<br>
        Total bardage : ${totalML.toFixed(1)} ml<br>
        Nombre de lames : ${nbLames}<br>
        Couvre-joints : ${mlCouv.toFixed(1)} ml (${nbCouv} pièces)
    `;
}

largeurMur.addEventListener("input", () => {
    if (surface.value && largeurMur.value) {
        hauteurMur.value = (surface.value / largeurMur.value).toFixed(2);
    }
    calculer();
});

hauteurMur.addEventListener("input", () => {
    if (surface.value && hauteurMur.value) {
        largeurMur.value = (surface.value / hauteurMur.value).toFixed(2);
    }
    calculer();
});

document.querySelectorAll("input").forEach(i => i.addEventListener("input", calculer));
document.querySelectorAll(".buttons-pertes button").forEach(b =>
    b.addEventListener("click", () => {
        pertes.value = b.dataset.pertes;
        calculer();
    })
);

claireVoie.addEventListener("change", () => {
    espacementSection.style.display = claireVoie.checked ? "block" : "none";
    calculer();
});

calculer();
</script>
</body>
</html>
